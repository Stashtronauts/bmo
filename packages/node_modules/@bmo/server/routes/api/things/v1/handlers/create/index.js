import methods from 'http-methods-enum';
import { CREATED } from 'http-status-codes';
import schema from '../../schema';
export default ({
	dependencies: {
		repositories: { thing },
		schemas: { thing: thingSchema }
	},
	routes: { things }
}) => {
	return {
		path: things.v1,
		schema: thingSchema.post,
		method: methods.POST,
		handler: async (ctx) => {
			try {
				ctx.response.body = await thing.create(ctx.request.body);
				ctx.status = CREATED;
			} catch (e) {
				ctx.error = e;
				await next();
			}
		}
	};
};
